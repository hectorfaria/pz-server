- name: Install | Add i386 architecture
  command: sudo dpkg --add-architecture i386

- name: Install | (lib32) Packages
  become: true
  apt:
    name: lib32gcc1
    update_cache: true

- name: accept steam license
  become: true
  debconf:
    name: "steam"
    question: "steam/question"
    value: "I AGREE"
    vtype: "select"

- name: Install SteamCMD
  become: true
  apt:
    name: steamcmd
    update_cache: yes

- name: Install zomboid dedicated server via SteamCMD
  become: true
  become_method: su
  become_user: pzuser
  command: "steamcmd +login anonymous +force_install_dir {{zomboid_server_dir}} +app_update 380870 validate +quit"
  register: zomboid_install

- name: Print zomboid install result
  debug: var=zomboid_install.stdout_lines
